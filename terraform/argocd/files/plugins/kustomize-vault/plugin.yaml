---
apiVersion: argoproj.io/v1alpha1
kind: ConfigManagementPlugin
metadata:
  name: kustomize-vault-plugin
spec:
  version: v1.0
  allowConcurrency: true
  lockRepo: false
  discover:
    find:
      command:
        - find
        - "."
        - -name
        - kustomization.yaml
  generate:
    command:
      - sh
      - "-c"
      - "kustomize build --enable-helm . | argocd-vault-plugin generate -"
